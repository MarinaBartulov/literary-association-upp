<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_0ijr9rg" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.4.0">
  <bpmn:process id="Process_Reader_Reg" name="Reader Registration Process" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1" camunda:initiator="newReader">
      <bpmn:outgoing>Flow_09055y7</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_09055y7" sourceRef="StartEvent_1" targetRef="Task_Reader_Reg_Form" />
    <bpmn:userTask id="Task_Reader_Reg_Form" name="Reader Registration Form" camunda:assignee="${newReader}">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="firstName" label="First name" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="lastName" label="Last name" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="city" label="City" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="country" label="Country" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="email" label="Email" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="username" label="Username" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="password" label="Password" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
              <camunda:constraint name="minlength" config="8" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="confirmPassword" label="Confirm password" type="string">
            <camunda:validation>
              <camunda:constraint name="required" />
              <camunda:constraint name="minlength" config="8" />
            </camunda:validation>
          </camunda:formField>
          <camunda:formField id="genres" label="Genres" type="enum" />
          <camunda:formField id="betaReader" label="Beta-reader" type="boolean" />
          <camunda:formField id="betaGenres" label="Genres for beta-reader" type="enum" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_012nxvq</bpmn:incoming>
      <bpmn:incoming>Flow_09055y7</bpmn:incoming>
      <bpmn:outgoing>Flow_07d7gvx</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_07d7gvx" sourceRef="Task_Reader_Reg_Form" targetRef="Task_Reader_Validation" />
    <bpmn:serviceTask id="Task_Reader_Validation" name="Reader Validation" camunda:class="team16.literaryassociation.services.ReaderValidationService">
      <bpmn:incoming>Flow_07d7gvx</bpmn:incoming>
      <bpmn:outgoing>Flow_0y1wx3i</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_05xrwvl">
      <bpmn:incoming>Flow_0y1wx3i</bpmn:incoming>
      <bpmn:outgoing>Flow_012nxvq</bpmn:outgoing>
      <bpmn:outgoing>Flow_0uvc4uu</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="Flow_0y1wx3i" sourceRef="Task_Reader_Validation" targetRef="Gateway_05xrwvl" />
    <bpmn:sequenceFlow id="Flow_012nxvq" name="Validation failed" sourceRef="Gateway_05xrwvl" targetRef="Task_Reader_Reg_Form">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isValid == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0uvc4uu" name="Validation succeeded" sourceRef="Gateway_05xrwvl" targetRef="Task_Save_Reader">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${isValid == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:serviceTask id="Task_Save_Reader" name="Save Reader" camunda:class="team16.literaryassociation.services.SaveReaderService">
      <bpmn:incoming>Flow_0uvc4uu</bpmn:incoming>
      <bpmn:outgoing>Flow_0lvogh3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0lvogh3" sourceRef="Task_Save_Reader" targetRef="Task_Send_Email" />
    <bpmn:serviceTask id="Task_Send_Email" name="Send Email" camunda:class="team16.literaryassociation.services.SendEmailService">
      <bpmn:incoming>Flow_0lvogh3</bpmn:incoming>
      <bpmn:outgoing>Flow_0k4flf5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_06zacrt" sourceRef="Event_0h0j32h" targetRef="Task_Remove_Reader" />
    <bpmn:serviceTask id="Task_Remove_Reader" name="Remove Reader" camunda:class="team16.literaryassociation.services.RemoveNewUserService">
      <bpmn:incoming>Flow_06zacrt</bpmn:incoming>
      <bpmn:outgoing>Flow_1wqzceb</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0k4flf5" sourceRef="Task_Send_Email" targetRef="Task_Activation_Reader" />
    <bpmn:boundaryEvent id="Event_0h0j32h" attachedToRef="Task_Activation_Reader">
      <bpmn:outgoing>Flow_06zacrt</bpmn:outgoing>
      <bpmn:timerEventDefinition id="TimerEventDefinition_0gnazz1">
        <bpmn:timeDuration xsi:type="bpmn:tFormalExpression">PT5M</bpmn:timeDuration>
      </bpmn:timerEventDefinition>
    </bpmn:boundaryEvent>
    <bpmn:endEvent id="Event_1b0da0o">
      <bpmn:incoming>Flow_1wqzceb</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1wqzceb" sourceRef="Task_Remove_Reader" targetRef="Event_1b0da0o" />
    <bpmn:endEvent id="Event_08t9t8u">
      <bpmn:incoming>Flow_01vatei</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_01vatei" sourceRef="Task_Activation_Reader" targetRef="Event_08t9t8u" />
    <bpmn:userTask id="Task_Activation_Reader" name="Activation Reader" camunda:assignee="${newReader}">
      <bpmn:incoming>Flow_0k4flf5</bpmn:incoming>
      <bpmn:outgoing>Flow_01vatei</bpmn:outgoing>
    </bpmn:userTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_Reader_Reg">
      <bpmndi:BPMNEdge id="Flow_01vatei_di" bpmnElement="Flow_01vatei">
        <di:waypoint x="1200" y="277" />
        <di:waypoint x="1252" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1wqzceb_di" bpmnElement="Flow_1wqzceb">
        <di:waypoint x="1200" y="120" />
        <di:waypoint x="1252" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0k4flf5_di" bpmnElement="Flow_0k4flf5">
        <di:waypoint x="1050" y="277" />
        <di:waypoint x="1100" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06zacrt_di" bpmnElement="Flow_06zacrt">
        <di:waypoint x="1150" y="219" />
        <di:waypoint x="1150" y="160" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0lvogh3_di" bpmnElement="Flow_0lvogh3">
        <di:waypoint x="900" y="277" />
        <di:waypoint x="950" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0uvc4uu_di" bpmnElement="Flow_0uvc4uu">
        <di:waypoint x="705" y="277" />
        <di:waypoint x="800" y="277" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="723" y="246" width="54" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_012nxvq_di" bpmnElement="Flow_012nxvq">
        <di:waypoint x="680" y="302" />
        <di:waypoint x="680" y="370" />
        <di:waypoint x="370" y="370" />
        <di:waypoint x="370" y="317" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="489" y="352" width="76" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0y1wx3i_di" bpmnElement="Flow_0y1wx3i">
        <di:waypoint x="600" y="277" />
        <di:waypoint x="655" y="277" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="601" y="276" width="54" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_07d7gvx_di" bpmnElement="Flow_07d7gvx">
        <di:waypoint x="420" y="277" />
        <di:waypoint x="500" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_09055y7_di" bpmnElement="Flow_09055y7">
        <di:waypoint x="215" y="277" />
        <di:waypoint x="320" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="259" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_193rjeb_di" bpmnElement="Task_Reader_Reg_Form">
        <dc:Bounds x="320" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0h4oepz_di" bpmnElement="Task_Save_Reader">
        <dc:Bounds x="800" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1qzr1b1_di" bpmnElement="Task_Send_Email">
        <dc:Bounds x="950" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0l0cd5v_di" bpmnElement="Task_Remove_Reader">
        <dc:Bounds x="1100" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1b0da0o_di" bpmnElement="Event_1b0da0o">
        <dc:Bounds x="1252" y="102" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_08t9t8u_di" bpmnElement="Event_08t9t8u">
        <dc:Bounds x="1252" y="259" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0bvrfri_di" bpmnElement="Task_Reader_Validation">
        <dc:Bounds x="500" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_05xrwvl_di" bpmnElement="Gateway_05xrwvl" isMarkerVisible="true">
        <dc:Bounds x="655" y="252" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1bzjv8r_di" bpmnElement="Task_Activation_Reader">
        <dc:Bounds x="1100" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0outvys_di" bpmnElement="Event_0h0j32h">
        <dc:Bounds x="1132" y="219" width="36" height="36" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
